<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>
			{% block title %}Bienvenue !
			{% endblock %}
		</title>
		<link
		rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>ðŸŒ±</text></svg>">

		{# Lien vers Bootstrap si tu l'utilises #}
		<link
		href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
		{# Font Awesome pour les icÃ´nes #}
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
		<link rel="stylesheet" href="{{ asset('css/formulaireCarbone.css') }}">
		<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@700&family=Montserrat:wght@400;700&display=swap" rel="stylesheet"> {% block stylesheets %}{% endblock %}
		<style>
			.navbar-energreen {
				background: linear-gradient(135deg, #112512ff 0%, #2e7d32 100%);
				box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
				padding: 1.3rem 0;
			}
			.navbar-energreen .navbar-brand {
				color: white !important;
				font-weight: bold;
				font-size: 1.5rem;
			}
			.navbar-energreen .nav-link {
				color: rgba(255, 255, 255, 0.9) !important;
				margin: 0 10px;
				transition: color 0.3s;
			}
			.navbar-energreen .nav-link:hover {
				color: white !important;
			}
			.navbar-energreen .nav-link.active {
				color: white !important;
				border-bottom: 3px solid white;
				font-weight: 600;
			}
			.profile-dropdown .dropdown-toggle {
				background: none;
				border: none;
				padding: 0;
				display: flex;
				align-items: center;
				color: white;
			}
			.profile-dropdown .dropdown-toggle:hover {
				background: none;
			}
			.profile-icon {
				background: rgba(255, 255, 255, 0.2);
				border: 2px solid rgba(255, 255, 255, 0.3);
				border-radius: 50%;
				width: 40px;
				height: 40px;
				display: flex;
				align-items: center;
				justify-content: center;
				font-size: 1.2rem;
				transition: background-color 0.3s;
			}
			.profile-icon:hover {
				background: rgba(255, 255, 255, 0.3);
			}
			.profile-dropdown .dropdown-toggle::after {
				display: none;
			}
			.profile-dropdown .dropdown-menu {
				border-radius: 10px;
				box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
				border: none;
				min-width: 200px;
				margin-top: 10px !important;
				right: 0 !important;
				left: auto !important;
				transform: translateX(0) !important;
				position: absolute !important;
			}
			.profile-dropdown {
				position: relative;
			}
			@media(max-width: 991px) {
				.profile-dropdown .dropdown-menu {
					right: 15px !important;
				}
			}
			.profile-dropdown .dropdown-item {
				padding: 10px 20px;
				transition: background-color 0.2s;
			}
			.profile-dropdown .dropdown-item:hover {
				background-color: #f0f4f1;
			}
			.profile-dropdown .dropdown-divider {
				margin: 5px 0;
			}
		</style>
	</head>
	<body>
		{% if app.user %}
			{# Navbar globale pour les utilisateurs connectÃ©s #}
			<nav class="navbar navbar-expand-lg navbar-energreen">
				<div class="container-fluid">
					<a class="navbar-brand" href="{{ path('app_home') }}">
						<img src="{{ asset('/images/logo-energreen.png') }}" alt="Energreen Logo" height="30">
					</a>
					<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" style="border-color: rgba(255,255,255,0.5);">
						<span class="navbar-toggler-icon" style="filter: invert(1);"></span>
					</button>
					<div class="collapse navbar-collapse" id="navbarNav">
						<ul class="navbar-nav me-auto">
							<li class="nav-item">
								<a class="nav-link {{ app.request.attributes.get('_route') == 'app_dashboard' ? 'active' : '' }}" href="{{ path('app_dashboard') }}">Dashboard</a>
							</li>

							{% if app.user and app.user.lodgment is not null %}
								<li class="nav-item">
									<a class="nav-link {{ app.request.attributes.get('_route') == 'app_calculator_consumption' ? 'active' : '' }}" href="{{ path('app_calculator_consumption') }}">Consommation Ã©lectrique</a>
								</li>
								<li class="nav-item">
									<a class="nav-link {{ app.request.attributes.get('_route') == 'app_formulaire' ? 'active' : '' }}" href="{{ path('app_formulaire') }}">Empreinte carbone</a>
								</li>
							{% endif %}
						</ul>
						<ul class="navbar-nav ms-auto" style="padding-right: 15px;">
							<li class="nav-item dropdown profile-dropdown">
								<a class="nav-link dropdown-toggle d-flex align-items-center gap-2" href="#" id="profileDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" style="padding-right: 0;">
									<span style="color: white; font-weight: 500;">
										{% if app.user.prenom %}
											{{ app.user.prenom }}
										{% elseif app.user.nom %}
											{{ app.user.nom }}
										{% else %}
											{{ app.user.email }}
										{% endif %}
									</span>
									<span class="profile-icon">
										<i class="fas fa-user"></i>
									</span>
								</a>
								<ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profileDropdown">
									<li>
										<span class="dropdown-item-text">
											<strong>{{ app.user.prenom ?? app.user.nom ?? 'Utilisateur' }}</strong><br>
											<small class="text-muted">{{ app.user.email }}</small>
										</span>
									</li>
									<li><hr class="dropdown-divider"></li>
									<li>
										<a class="dropdown-item" href="{{ path('app_energreen_profil') }}">
											<i class="fas fa-user me-2"></i>Mon profil</a>
									</li>
									<li>
										<a class="dropdown-item" href="{{ path('app_profile_edit') }}">
											<i class="fas fa-cog me-2"></i>Modifier mon compte</a>
									</li>
									<li><hr class="dropdown-divider"></li>
									<li>
										<form method="post" action="{{ path('app_logout') }}" style="margin: 0;">
											<input type="hidden" name="_csrf_token" value="{{ csrf_token('logout') }}"/>
											<button type="submit" class="dropdown-item text-danger" style="border: none; background: none; width: 100%; text-align: left; padding: 10px 20px;">
												<i class="fas fa-sign-out-alt me-2"></i>DÃ©connexion</button>
										</form>
									</li>
								</ul>
							</li>
						</ul>
					</div>
				</div>
			</nav>
		{% endif %}

		{% block body %}{% endblock %}


		{% block javascripts %}
			<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>


			<div class="card-footer text-center py-3 bg-light">
				<small class="text-muted">Fait avec
					<span style="color: #e14646ff;">&hearts;</span>
					Energreen - 2026</small>
			</div>
		{% endblock %}
	</body>
</html>
